Description: fix DoS via insufficient note headers
Origin: upstream, https://github.com/file/file/commit/39c7ac1106be844a5296d3eb5971946cc09ffda0

Index: file-5.09/src/readelf.c
===================================================================
--- file-5.09.orig/src/readelf.c	2015-01-27 09:39:22.754968810 -0500
+++ file-5.09/src/readelf.c	2015-01-27 09:39:22.750968779 -0500
@@ -369,6 +369,13 @@
 	uint32_t namesz, descsz;
 	unsigned char *nbuf = CAST(unsigned char *, vbuf);
 
+	if (xnh_sizeof + offset > size) {
+		/*
+		 * We're out of note headers.
+		 */
+		return xnh_sizeof + offset;
+	}
+
 	(void)memcpy(xnh_addr, &nbuf[offset], xnh_sizeof);
 	offset += xnh_sizeof;
 

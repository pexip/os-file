Origin: https://github.com/php/php-src/commit/7ba1409a1aee5925180de546057ddd84ff267947
Subject: segfault in cd.c. Incomplete fix for CVE-2012-1571
Author: Remi Collet

---
 src/cdf.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: b/src/cdf.c
===================================================================
--- a/src/cdf.c
+++ b/src/cdf.c
@@ -810,7 +810,7 @@
 		q = (const uint8_t *)(const void *)
 		    ((const char *)(const void *)p + ofs
 		    - 2 * sizeof(uint32_t));
-		if (q > e) {
+		if (q < p || q > e) {
 			DPRINTF(("Ran of the end %p > %p\n", q, e));
 			goto out;
 		}
